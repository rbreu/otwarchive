<% Tr8n::Config.with_options(:default_locale => 'en-US', :admin => true) do %>
	<%= render :partial => "/tr8n/common/header" %>
	<%= render :partial => "breadcrumb" %>

	<div style="color:red">Here be place for search/filter options (show all with x number of translations, ...)</div>
	
	<div style="margin-top:10px; margin-bottom:10px; border: 1px dotted #ccc; padding:10px;">
    <% if @translation_keys.any? %>
      <%= render :partial => "/tr8n/common/paginator", :locals => {:objects => @translation_keys, :subject => 'phrase'} %>
    <% end %>
	
	  <table style="width:100%">
	    <tr style="border-bottom:2px solid #ccc;">
	       <td style="width:30%;padding:5px; background: #f9f8f7; font-size:16px; color:grey; ">
				   <%=tra("Original Phrase")%>
				 </td>
	       <td style="width:70%;padding:5px; font-size:16px; color:grey; " colspan="2">
				   <%=tra("Top {language} Translations", nil, :language => tr8n_current_language.native_name) %>
				 </td>
	    </tr>  
	    <% @translation_keys.each do |tk| %>
	      <tr style="border-bottom:1px solid #ccc;">
	        <% color = tk.locked? ? "#ECFFEF" : "#FDFDDF" %>
	        <td style="padding:5px; background: <%=color%>; ">
	          <% if tk.locked? %>
	            <div style="float:right"><%=image_tag("/tr8n/images/lock.png", :style=>"width:12px", :title => trla("This phrase is locked"))%></div>
	          <% end %>
	          <%=link_to(tk.default_decoration, :action => :view, :translation_key_id => tk.id, :section_key => @section_key)%>
	          <div style="color:grey;font-size:10px;padding-top:3px;"><%=tk.description%></div>
	        </td>
	        <td style="padding:5px; vertical-align:top">
	          <div id="tr8n_translator_votes_for_<%=tk.key%>">
	          <% translations = tk.translations_for(tr8n_current_language) %>
				    <% if translations.empty? %>
	            <%= tra("There are no translations for this phrase.") %> 
							<% unless tk.locked? %>
			    <%= tra("Be the first one to") %> <%= link_to(h(tra("translate it")), :controller => "/tr8n/phrases", :action => :view, :translation_key_id => tk.id, :section_key => @section_key) %>.
							<% end %>				
				    <% else %>   
	            <%= render :partial => "/tr8n/common/translation_votes", :locals => {:translation_key => tk, :translations => translations[0..4], :section_key => @section_key} %>
						<% end %>	
	          </div>  
	        </td>
	      </tr>
	    <% end %>
	  </table>
	  
		<% if @translation_keys.empty? %>
		    <div style="text-align:left; padding-top:10px; font-size:12px;"><%=trla("No phrases found")%></div>
		<% end %>
		
		<% if @translation_keys.any? %>
	    <%= render :partial => "/tr8n/common/paginator", :locals => {:objects => @translation_keys, :subject => 'phrase'} %>
		<% end %>
	</div>
	<%= render :partial => "/tr8n/common/footer" %>
	
	<script>
	  function toggleFilterOptions() {
	    if (Tr8n.element("phrase_type").value == "with") {
	      Tr8n.Effects.show("extended_filter_options");
	    } else {
	      Tr8n.Effects.hide("extended_filter_options");
	    }
	  }
	</script>
<% end %>
